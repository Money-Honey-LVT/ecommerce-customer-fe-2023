import{k as c,u as E,a as S,j as s,C as g,b as C,F as w,T as m,G as P,c as R,i as T,H as y,J as v,A as z,d as L,S as A,v as q,R as D}from"./index-4732123a.js";import{C as G}from"./ColorSelector-092cc901.js";import{C as b,a as I}from"./Card-ee0b218a.js";function U(e,t,r={leading:!1}){const[d,o]=c.useState(e),a=c.useRef(null),l=c.useRef(!0),u=()=>window.clearTimeout(a.current);return c.useEffect(()=>u,[]),[d,f=>{u(),l.current&&r.leading?o(f):a.current=window.setTimeout(()=>{l.current=!0,o(f)},t),l.current=!1}]}function j(){const[e,t]=c.useState(!1),r=c.useRef(null),d=c.useCallback(()=>t(!0),[]),o=c.useCallback(()=>t(!1),[]);return c.useEffect(()=>{if(r.current)return r.current.addEventListener("mouseenter",d),r.current.addEventListener("mouseleave",o),()=>{var a,l;(a=r.current)==null||a.removeEventListener("mouseenter",d),(l=r.current)==null||l.removeEventListener("mouseleave",o)}},[]),{ref:r,hovered:e}}const F=T(e=>({card:{":hover":{background:"black",color:"white"}}})),H=({productId:e,color:t,sizes:r})=>{const{classes:d}=F(),o=E(),a=S(),l=u=>{const h={productId:e,color:t,size:u,quantity:1};y({onSuccess:()=>{o(v.AddCart(h,{onSuccess:()=>{o(v.GetCart())}}))}},a)};return s(g,{children:s(b,{shadow:"xs",radius:"md",padding:"xs",bottom:15,sx:{position:"absolute",backdropFilter:"blur(5px)",backgroundColor:"rgba(255, 255, 255, 0.4)"},children:r.length>0?C(w,{children:[s(g,{mb:5,children:s(m,{weight:"bold",size:"sm",children:"Thêm nhanh vào giỏ hàng +"})}),s(P,{children:r.map((u,h)=>s(R,{span:3,onClick:()=>l(u),children:s(b,{radius:"md",p:5,className:d.card,children:s(g,{children:s(m,{weight:"500",children:u})})})},h))})]}):s(m,{weight:"bold",size:"sm",children:"Sản phẩm đang tạm hết hàng"})})})},V=({product:e})=>{const t=z(e==null?void 0:e.properties),r=S(),{hovered:d,ref:o}=j(),[a,l]=c.useState(""),u=()=>{r(`${D.PRODUCT.INDEX}/${e==null?void 0:e.id}`)},h=n=>a?a===n:n===t[0],f=n=>{l(n)},k=()=>{if(a){const n=e==null?void 0:e.properties.find(i=>i.color===a);return n?n.imagePath:null}else{const n=e==null?void 0:e.properties.find(i=>i.color===t[0]);return n?n.imagePath:null}},x=()=>{const n=new Set;return e==null||e.properties.forEach(i=>{a?i.color===a&&i.quantity>0&&n.add(i.size):i.color===t[0]&&i.quantity>0&&n.add(i.size)}),[...n]};return C(b,{padding:"md",radius:"md",sx:{cursor:"pointer"},children:[s(I,{sx:{backgroundImage:`url(${k()})`,position:"relative",backgroundPosition:"center",backgroundSize:"300px"},h:420,ref:o,mb:10,children:d&&(e!=null&&e.id)?s(H,{productId:e==null?void 0:e.id,color:a||t[0],sizes:x()}):null}),s(L,{children:t==null?void 0:t.map((n,i)=>s(G,{color:n,isSelected:h(n),onClick:()=>f(n)},i))}),C(A,{mt:5,spacing:2,onClick:()=>u(),children:[s(m,{children:e==null?void 0:e.name}),s(m,{weight:"bolder",children:q(e==null?void 0:e.price)})]})]})};export{V as P,U as u};
