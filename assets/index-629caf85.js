import{b as c,F as B,G as y,j as e,c as a,T as l,D as z,d as w,x,y as R,_ as k,k as p,z as G,u as q,a as M,t as V,A as Q,C as v,S as F,v as W,E as L,B as H,w as J,i as K,H as _,J as P}from"./index-4732123a.js";import{R as $}from"./Rating-70908286.js";import{C as U}from"./ColorSelector-092cc901.js";import{P as Y}from"./product.actions-948b26f3.js";import{C as Z}from"./Card-ee0b218a.js";import{I as ee}from"./Image-ff6b5269.js";import{N as te}from"./NumberInput-1e06c60e.js";import"./TextInput-86f1386a.js";import"./use-input-props-0443fea7.js";import"./Input-2a654f21.js";const ne=({rating:s})=>c(B,{children:[c(y,{children:[e(a,{span:12,md:4,children:e($,{value:s==null?void 0:s.score})}),c(a,{span:12,md:8,children:[e(l,{weight:"bold",size:"sm",children:s==null?void 0:s.author}),e(l,{size:"sm",children:s==null?void 0:s.review})]})]}),e(z,{my:20})]});var m=(s=>(s.XS="XS",s.S="S",s.M="M",s.L="L",s.XL="XL",s.XXL="XXL",s))(m||{});const A=[m.XS,m.S,m.M,m.L,m.XL,m.XXL],se=({availableSizes:s,sizeSelected:f,setSizeSelected:b})=>{const o=i=>{u().includes(i)?b(i):x("Thông báo","Sản phẩm này hiện đang hết hàng",R.ERROR)},S=i=>i==f,u=()=>k.intersection(s,A);return e(w,{children:A.map((i,t)=>e(Z,{withBorder:!0,bg:S(i)?"black":"#D9D9D9",c:S(i)?"white":"",radius:"lg",py:"xs",px:"lg",sx:{cursor:"pointer",fontWeight:"bold"},className:u().includes(i)?"":"outOfStock",onClick:()=>o(i),children:i},t))})},ie=K(s=>({image:{[s.fn.smallerThan("sm")]:{},[s.fn.largerThan("sm")]:{width:"672",height:"990"}},width:{[s.fn.smallerThan("sm")]:{width:"100%"},[s.fn.largerThan("sm")]:{width:"90%"}}})),re=()=>{const{classes:s}=ie(),[f,b]=p.useState(1),o=p.useRef(null),S=G().id,u=q(),i=M();p.useEffect(()=>{u(Y.GetProductById(parseInt(S||"")))},[]);const t=V(n=>n.products.productById),d=Q(t==null?void 0:t.properties),[g,D]=p.useState(d[0]),E=n=>d?g===n:!1,I=n=>{const r=t==null?void 0:t.properties.find(h=>h.color===n);return r?r.imagePath:null},T=n=>{const r=new Set;return t==null||t.properties.forEach(h=>{h.color===n&&h.quantity>0&&r.add(h.size)}),[...r]},[C,X]=p.useState(),N=(n,r)=>{const h=k.filter(t==null?void 0:t.properties,{color:n,size:r});return k.sumBy(h,"quantity")},O=n=>{D(n),X(T(n)[0])},j=()=>{if(t!=null&&t.id)if(C){const n={productId:t.id,quantity:f,size:C,color:g};if(!g){x("Thông báo","Vui lòng chọn màu cho sản phẩm",R.ERROR);return}if(f<1){x("Thông báo","Vui lòng chọn số lượng",R.ERROR);return}_({onSuccess:()=>{u(P.AddCart(n,{onSuccess:()=>u(P.GetCart())}))}},i)}else x("Thông báo","Vui lòng chọn kích thước cho sản phẩm",R.ERROR)};return t?c(B,{children:[e(v,{className:s.width,children:c(y,{w:"100%",children:[e(a,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},xs:12,sm:12,md:6,lg:7,xl:7,children:e(ee,{className:s.image,radius:"lg",fit:"contain",sx:{display:"flex",justifyContent:"center",alignItems:"center"},src:I(g)||I(d[0]),withPlaceholder:!0})}),e(a,{xs:12,sm:12,md:6,lg:5,xl:5,children:c(F,{children:[e(l,{weight:600,size:32,children:t==null?void 0:t.name}),e(l,{size:"lg",children:W(t==null?void 0:t.price)}),e(l,{size:"lg",children:"Màu sắc:"}),e(w,{children:d==null?void 0:d.map((n,r)=>e(U,{color:n,isSelected:E(n),onClick:()=>O(n)},r))}),e(l,{size:"lg",children:"Kích thước:"}),e(w,{children:e(se,{availableSizes:T(g||d[0]),sizeSelected:C,setSizeSelected:X})}),c(y,{align:"center",children:[e(a,{xs:4,md:4,children:c(w,{spacing:3,children:[e(L,{size:32,radius:"lg",variant:"filled",color:"dark",onClick:()=>{var n;return(n=o==null?void 0:o.current)==null?void 0:n.decrement()},children:"–"}),e(te,{hideControls:!0,value:f,onChange:n=>b(n),handlersRef:o,max:N(g,C),min:1,step:1,styles:{input:{width:40,textAlign:"center"}},radius:"lg"}),e(L,{size:32,radius:"lg",variant:"filled",color:"dark",onClick:()=>{var n;return(n=o==null?void 0:o.current)==null?void 0:n.increment()},children:"+"})]})}),e(a,{xs:8,md:8,children:e(H,{w:"100%",leftIcon:e(J,{}),radius:"md",onClick:j,children:e(l,{size:"sm",children:"Thêm vào giỏ hàng"})})})]}),e(z,{orientation:"horizontal",my:"md"}),e(l,{weight:"bold",size:"md",children:"Đặc điểm nổi bật"}),c(l,{size:"md",children:["- ",t.description]})]})})]})}),e(z,{mt:80}),t.reviews.length>0?e(v,{w:"90%",children:c(y,{w:"100%",children:[e(a,{span:12,children:c(l,{weight:"bolder",size:26,mt:20,children:[t.reviews.length," Đánh giá"]})}),t.reviews.map((n,r)=>e(a,{xs:12,md:6,children:e(ne,{rating:n})},r))]})}):e(v,{mt:"md",children:e(l,{weight:"bold",size:"lg",children:"Sản phẩm chưa có đánh giá nào"})})]}):null},Se=re;export{Se as default};
